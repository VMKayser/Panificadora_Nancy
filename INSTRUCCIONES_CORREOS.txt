╔══════════════════════════════════════════════════════════════════════════════╗
║                                                                              ║
║         🎉 SISTEMA DE CORREOS ELECTRÓNICOS INSTALADO EXITOSAMENTE 🎉        ║
║                                                                              ║
╚══════════════════════════════════════════════════════════════════════════════╝


┌──────────────────────────────────────────────────────────────────────────────┐
│  ✅ LO QUE YA ESTÁ HECHO:                                                    │
└──────────────────────────────────────────────────────────────────────────────┘

   ✓ Clases de correo creadas (Mailables)
   ✓ Plantillas HTML hermosas y responsive
   ✓ Integración en controladores
   ✓ Cola de trabajos configurada
   ✓ Worker de cola iniciado
   ✓ Comando de prueba creado


┌──────────────────────────────────────────────────────────────────────────────┐
│  📧 TIPOS DE CORREOS QUE SE ENVÍAN AUTOMÁTICAMENTE:                          │
└──────────────────────────────────────────────────────────────────────────────┘

   1. 🎊 Correo de Bienvenida
      └─ Cuando: Un usuario se registra
      └─ A quién: Al email del nuevo usuario
      └─ Contenido: Bienvenida + qué puede hacer en la plataforma

   2. 📦 Pedido Confirmado
      └─ Cuando: Se crea un nuevo pedido
      └─ A quién: Al email del cliente
      └─ Contenido: Detalles completos del pedido + productos + total

   3. 🔄 Cambio de Estado del Pedido
      └─ Cuando: El admin cambia el estado (confirmado, preparando, listo, etc.)
      └─ A quién: Al email del cliente
      └─ Contenido: Nuevo estado + seguimiento + información según estado


┌──────────────────────────────────────────────────────────────────────────────┐
│  🚀 LO ÚNICO QUE TE FALTA: CONFIGURAR SMTP (5 minutos)                       │
└──────────────────────────────────────────────────────────────────────────────┘

   OPCIÓN 1: MAILTRAP (Recomendado para testing) ⭐⭐⭐
   ─────────────────────────────────────────────────
   
   ✅ GRATIS 100%
   ✅ Perfecto para desarrollo
   ✅ No envía correos reales (los "atrapa")
   ✅ Puedes ver cómo se ven en Gmail, Outlook, iPhone, etc.
   ✅ 5 minutos para configurar

   PASOS:
   
   1. Ir a: https://mailtrap.io/
   
   2. Crear cuenta gratis
   
   3. Entrar → "Email Testing" → "Inboxes" → "My Inbox"
   
   4. Copiar las credenciales (ejemplo):
      Host: sandbox.smtp.mailtrap.io
      Port: 2525
      Username: abc123def456
      Password: xyz789uvw012
   
   5. Editar archivo: backend/.env
      
      Cambiar estas líneas:
      
      MAIL_MAILER=smtp
      MAIL_HOST=sandbox.smtp.mailtrap.io
      MAIL_PORT=2525
      MAIL_USERNAME=abc123def456              ← Tu username de Mailtrap
      MAIL_PASSWORD=xyz789uvw012              ← Tu password de Mailtrap
      MAIL_ENCRYPTION=tls
      MAIL_FROM_ADDRESS="info@panificadoranancy.com"
      MAIL_FROM_NAME="Panificadora Nancy"
   
   6. Limpiar configuración:
      
      cd backend
      ./vendor/bin/sail artisan config:clear
      ./vendor/bin/sail artisan cache:clear
   
   7. ¡LISTO! Ahora prueba (ver sección de pruebas abajo)


   OPCIÓN 2: GMAIL (Para producción real)
   ───────────────────────────────────────
   
   ✅ Gratis hasta 500 correos/día
   ✅ Fácil de configurar
   ⚠️  Necesitas activar "Contraseñas de aplicaciones"
   
   PASOS:
   
   1. Ir a: https://myaccount.google.com/
   
   2. Seguridad → Verificación en 2 pasos → ACTIVAR
   
   3. Seguridad → Contraseñas de aplicaciones → Crear nueva
      Nombre: "Panificadora Nancy"
      Te dará una contraseña de 16 caracteres
   
   4. Editar backend/.env:
      
      MAIL_MAILER=smtp
      MAIL_HOST=smtp.gmail.com
      MAIL_PORT=587
      MAIL_USERNAME=tu_email@gmail.com       ← Tu Gmail
      MAIL_PASSWORD=xxxx xxxx xxxx xxxx      ← Contraseña de 16 caracteres
      MAIL_ENCRYPTION=tls
      MAIL_FROM_ADDRESS="tu_email@gmail.com"
      MAIL_FROM_NAME="Panificadora Nancy"
   
   5. Limpiar configuración y probar


┌──────────────────────────────────────────────────────────────────────────────┐
│  🧪 PROBAR QUE FUNCIONE:                                                     │
└──────────────────────────────────────────────────────────────────────────────┘

   MÉTODO 1: Comando de prueba rápida
   ───────────────────────────────────
   
   cd backend
   
   # Probar correo de bienvenida
   ./vendor/bin/sail artisan enviar:correo-prueba bienvenida tu@email.com
   
   # Probar correo de pedido confirmado
   ./vendor/bin/sail artisan enviar:correo-prueba pedido-confirmado tu@email.com
   
   # Probar correo de cambio de estado
   ./vendor/bin/sail artisan enviar:correo-prueba pedido-estado tu@email.com


   MÉTODO 2: Probar desde la aplicación
   ─────────────────────────────────────
   
   1. Abre el frontend: http://localhost:5174/
   
   2. Regístrate con un email real
      → Deberías recibir el correo de bienvenida
   
   3. Haz un pedido
      → Deberías recibir el correo de confirmación
   
   4. Como admin, cambia el estado del pedido
      → Deberías recibir el correo de cambio de estado


   MÉTODO 3: Probar con Tinker
   ───────────────────────────
   
   ./vendor/bin/sail artisan tinker
   
   # Correo de bienvenida
   $user = App\Models\User::first();
   Mail::to('tu@email.com')->send(new App\Mail\BienvenidaUsuario($user));
   
   # Correo de pedido
   $pedido = App\Models\Pedido::with('detalles.producto', 'metodoPago')->first();
   Mail::to('tu@email.com')->send(new App\Mail\PedidoConfirmado($pedido));
   
   exit


┌──────────────────────────────────────────────────────────────────────────────┐
│  📍 DÓNDE VER LOS CORREOS:                                                   │
└──────────────────────────────────────────────────────────────────────────────┘

   Si usas MAILTRAP:
   → Ir a https://mailtrap.io/
   → Email Testing → My Inbox
   → Verás todos los correos "enviados"
   
   Si usas GMAIL:
   → Revisa tu bandeja de entrada normal
   
   Si está en modo LOG (por defecto):
   → Los correos se guardan en: backend/storage/logs/laravel.log
   → Ver con: tail -f backend/storage/logs/laravel.log


┌──────────────────────────────────────────────────────────────────────────────┐
│  🔧 VERIFICAR QUE TODO ESTÉ CORRIENDO:                                       │
└──────────────────────────────────────────────────────────────────────────────┘

   # Ver si el queue worker está corriendo
   ps aux | grep queue:work
   
   # Si no está corriendo, iniciarlo:
   cd backend
   ./vendor/bin/sail artisan queue:work --tries=3 &
   
   # Ver trabajos en cola
   ./vendor/bin/sail artisan queue:listen
   
   # Ver trabajos pendientes
   ./vendor/bin/sail artisan tinker
   DB::table('jobs')->count();
   exit


┌──────────────────────────────────────────────────────────────────────────────┐
│  🎨 PERSONALIZAR LOS CORREOS:                                                │
└──────────────────────────────────────────────────────────────────────────────┘

   Las plantillas están en:
   backend/resources/views/emails/
   
   - bienvenida.blade.php
   - pedido-confirmado.blade.php
   - pedido-estado-cambiado.blade.php
   
   Reemplaza:
   - [Tu teléfono] → Tu número real
   - [Tu email] → Tu email de contacto
   - [Tu dirección] → Dirección de la panadería


┌──────────────────────────────────────────────────────────────────────────────┐
│  ❓ SOLUCIÓN DE PROBLEMAS:                                                   │
└──────────────────────────────────────────────────────────────────────────────┘

   "Connection refused"
   → Verifica MAIL_HOST y MAIL_PORT en .env
   → Ejecuta: ./vendor/bin/sail artisan config:clear
   
   "Authentication failed"
   → Verifica MAIL_USERNAME y MAIL_PASSWORD
   → En Gmail, usa la contraseña de aplicación, no tu contraseña normal
   
   "Los correos no se envían"
   → Verifica que el queue worker esté corriendo
   → Ejecuta: ps aux | grep queue:work
   → Si no está, inicia: ./vendor/bin/sail artisan queue:work &
   
   "Los correos van a spam" (Gmail)
   → Usa SendGrid o Mailtrap
   → Configura SPF/DKIM en tu dominio


┌──────────────────────────────────────────────────────────────────────────────┐
│  📚 DOCUMENTACIÓN COMPLETA:                                                  │
└──────────────────────────────────────────────────────────────────────────────┘

   Lee los archivos:
   
   - COMO_CONFIGURAR_CORREOS.md → Guía completa paso a paso
   - Instrucciones contenedor/CONFIGURACION_CORREOS.md → Detalles técnicos


╔══════════════════════════════════════════════════════════════════════════════╗
║                                                                              ║
║  🎯 RESUMEN: Solo necesitas hacer 3 cosas:                                  ║
║                                                                              ║
║  1. Crear cuenta en Mailtrap (5 min) → https://mailtrap.io/                ║
║  2. Copiar credenciales al archivo .env                                     ║
║  3. Ejecutar: ./vendor/bin/sail artisan config:clear                       ║
║                                                                              ║
║  ¡Y LISTO! 🎉                                                               ║
║                                                                              ║
╚══════════════════════════════════════════════════════════════════════════════╝
